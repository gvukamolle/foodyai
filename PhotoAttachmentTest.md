# Тестирование прикрепления фото к сообщениям

## Что было изменено:

### 1. **CalorieTrackerViewModel.kt**
- Добавлены поля `attachedPhoto` и `attachedPhotoPath` для хранения прикреплённого фото
- Метод `onPhotoSelected` теперь сохраняет фото во временный файл вместо показа диалога
- Добавлен метод `removeAttachedPhoto` для удаления прикреплённого фото
- Добавлен метод `sendMessageWithPhoto` для отправки сообщения с фото
- Обновлён метод `sendMessage` для проверки наличия прикреплённого фото
- Закомментированы все вызовы `showAILoadingScreen` (отключён экран загрузки AI)

### 2. **AnimatedMainScreen.kt**
- Добавлен компонент `AttachedPhotoPreview` для отображения превью прикреплённого фото
- В нижней панели добавлено отображение прикреплённого фото над полем ввода
- Обновлена логика кнопки отправки - теперь она активна, если есть текст ИЛИ прикреплённое фото
- Добавлен параметр `hasAttachment` в `AnimatedInputField`

### 3. **DialogIntegrations.kt**
- Закомментирован диалог подтверждения фото (`EnhancedPhotoConfirmDialog`)

## Как работает новый функционал:

1. **Прикрепление фото**:
   - Пользователь нажимает "Сфоткать" или "Выбрать фото"
   - Фото сразу прикрепляется к текущему сообщению
   - Над полем ввода появляется превью фото с кнопкой удаления

2. **Удаление фото**:
   - Нажатие на крестик в правом верхнем углу превью удаляет прикреплённое фото

3. **Отправка сообщения**:
   - Можно отправить только текст
   - Можно отправить только фото
   - Можно отправить текст с фото
   - При отправке фото автоматически отправляется на анализ AI

## Тестовые сценарии:

1. **Прикрепить фото из галереи**:
   - Нажать кнопку "+"
   - Выбрать "Выбрать фото"
   - Выбрать фото из галереи
   - Проверить, что появилось превью

2. **Сделать фото камерой**:
   - Нажать кнопку "+"
   - Выбрать "Сфоткать"
   - Сделать фото
   - Проверить, что появилось превью

3. **Удалить прикреплённое фото**:
   - Прикрепить фото
   - Нажать на крестик в превью
   - Проверить, что превью исчезло

4. **Отправить фото с текстом**:
   - Прикрепить фото
   - Написать текст
   - Нажать кнопку отправки
   - Проверить, что в чате появилось сообщение с фото и текстом

5. **Отправить только фото**:
   - Прикрепить фото
   - Не вводить текст
   - Нажать кнопку отправки
   - Проверить, что фото отправилось на анализ

## Примечания:
- Экран анализа AI полностью отключён
- Поддерживается только одно прикреплённое фото
- Фото сохраняются во временной директории и удаляются после отправки
